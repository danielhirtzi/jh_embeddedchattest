<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Einstein Bot Test</title>
</head>
<body>
  <h1>Welcome to the Einstein Bot Test Page 3</h1>

  <!-- Your embedded messaging code starts here -->
  <script type='text/javascript'>
    function initEmbeddedMessaging() {
      try {
        embeddedservice_bootstrap.settings.language = 'en_US';

        /*embeddedservice_bootstrap.prechatFieldComponents = [
        {
          "label": "Source Url",
          "value": window.location.href,
          "transcriptFields": [],
          "displayToAgent": true,
          "name": "SourceUrl", // This must match the Parameter API Name in Salesforce exactly
          "type": "input"
        }
        ];*/

        // Set the SourceUrl field to the current page URL
        embeddedservice_bootstrap.prechatFields = {
          SourceUrl: window.location.href
        };
        console.log('SourceUrl1: ', embeddedservice_bootstrap.prechatFields.SourceUrl);

        window.addEventListener("onEmbeddedMessagingReady", () => {
        console.log("Received the onEmbeddedMessagingReady eventâ€¦");

        // Send data to Salesforce
        embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({"SourceUrl" : "TEST"});
        });
        console.log('hidden SourceUrl: ', embeddedservice_bootstrap.prechatFields.SourceUrl);
        
        embeddedservice_bootstrap.init(
          '00DUC000001CQZG',
          'Omnichannel_Test_v1',
          'https://jameshardieeurope--jhfull.sandbox.my.site.com/ESWOmnichannelTestv11745415074581',
          {
            scrt2URL: 'https://jameshardieeurope--jhfull.sandbox.my.salesforce-scrt.com'
          }
        );
        console.log('Embedded Messaging initialized');
      } catch (err) {
        console.error('Error loading Embedded Messaging: ', err);
      }
    }
  </script>
  <script type='text/javascript' src='https://jameshardieeurope--jhfull.sandbox.my.site.com/ESWOmnichannelTestv11745415074581/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>
  <!-- Your embedded messaging code ends here -->

</body>
</html>
